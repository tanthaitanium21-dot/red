<!DOCTYPE html>

<html lang="th">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>'ราคากลาง'งานไฟฟ้าภายในบ้าน1  (Merged &amp; Fixed)</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;500;700&amp;display=swap" rel="stylesheet"/>
<style>
        body {
            font-family: 'Sarabun', sans-serif;
            background-color: #f4f7f9;
            color: #334155;
        }
        .tab-active {
            border-color: #3b82f6;
            color: #3b82f6;
            font-weight: 700;
        }
        .config-card {
            background-color: white;
            border-radius: 0.75rem;
            padding: 1.5rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.05), 0 2px 4px -2px rgb(0 0 0 / 0.05);
            border-left: 4px solid #3b82f6;
            transition: all 0.2s ease-in-out;
        }
        .config-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.07), 0 4px 6px -2px rgb(0 0 0 / 0.07);
        }
        .circuit-container {
            background-color: #f8fafc;
            padding: 1rem;
            border-radius: 0.5rem;
            margin-top: 1rem;
            border: 1px solid #e2e8f0;
        }
        .form-input {
            border-radius: 0.5rem;
            border-color: #cbd5e1;
            transition: all 0.2s ease-in-out;
        }
        .form-input:focus {
            --tw-ring-color: rgba(59, 130, 246, 0.4);
            --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);
            --tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(3px + var(--tw-ring-offset-width)) var(--tw-ring-color);
            box-shadow: var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000);
            border-color: #3b82f6;
        }
        .btn {
            border-radius: 0.5rem;
            font-weight: 700;
            padding-top: 0.75rem;
            padding-bottom: 0.75rem;
            transition: all 0.3s ease;
            box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        .btn:disabled {
            opacity: 0.7;
            cursor: not-allowed;
        }
        .btn-primary {
            background-image: linear-gradient(to right, #3b82f6, #2563eb);
            color: white;
        }
        .btn-primary:hover:not(:disabled) {
            transform: translateY(-1px);
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }
        .btn-secondary {
            background-color: #475569;
            color: white;
        }
        .btn-secondary:hover:not(:disabled) {
            background-color: #334155;
            transform: translateY(-1px);
        }

        @media print {
            body * { visibility: hidden; }
            #print-area, #print-area * { visibility: visible; }
            #print-area { display: block; position: absolute; left: 0; top: 0; width: 100%; }
            .no-print { display: none; }
        }
    </style>

<!-- Restored Province Rates Block -->
<script src="js/script.js"></script>

</head>
<body class="antialiased"><svg style="display:none;">
<symbol id="ic-folder" viewbox="0 0 24 24"><path d="M3 7a2 2 0 012-2h4l2 2h8a2 2 0 012 2v7a2 2 0 01-2 2H5a2 2 0 01-2-2z"></path></symbol>
<symbol id="ic-plug" viewbox="0 0 24 24"><path d="M6 3v6a6 6 0 0012 0V3"></path><path d="M8 3h8"></path></symbol>
<symbol id="ic-light" viewbox="0 0 24 24"><path d="M12 18v4M10 22h4M12 2a7 7 0 00-4 12v2h8v-2a7 7 0 00-4-12z"></path></symbol>
<symbol id="ic-outlet" viewbox="0 0 24 24"><rect height="18" rx="2" width="18" x="3" y="3"></rect><circle cx="9" cy="12" r="1.5"></circle><circle cx="15" cy="12" r="1.5"></circle></symbol>
</svg>
<div class="container mx-auto p-4 md:p-8">
<header class="text-center mb-10 no-print">
<h1 class="text-5xl font-bold text-blue-600 tracking-tight">'ราคากลาง'งานไฟฟ้าภายในบ้าน1 <span class="text-3xl text-amber-500"></span></h1>
<p class="text-xl text-slate-500 mt-2">โปรแกรมคำนวณสำหรับช่างไฟฟ้ายุคใหม่ ( Fixed)</p>
</header>
<div class="mb-6 no-print">
<div class="config-card">
<h2 class="text-2xl font-bold text-blue-600 border-b-2 border-slate-200 pb-2 mb-4">ข้อมูลโครงการ</h2>
<div class="grid grid-cols-1 md:grid-cols-3 gap-4">
<div>
<label class="block text-sm font-medium text-slate-600" for="project_name">ชื่อโครงการ</label>
<input class="form-input mt-1 block w-full" id="project_name" placeholder="เช่น บ้านคุณสมชาย" type="text"/>
</div>
<div>
<label class="block text-sm font-medium text-slate-600" for="customer_name">ชื่อลูกค้า</label>
<input class="form-input mt-1 block w-full" id="customer_name" placeholder="ชื่อ-นามสกุล" type="text"/>
</div>
<div>
<label class="block text-sm font-medium text-slate-600" for="report_date">วันที่</label>
<input class="form-input mt-1 block w-full" id="report_date" type="date"/>
</div>
</div>
</div>
</div>
<main class="grid grid-cols-1 lg:grid-cols-3 gap-8">
<div class="lg:col-span-2 space-y-6">
<section class="bg-white p-6 rounded-lg shadow-lg mb-6">
<h2 class="text-2xl font-bold mb-4 border-b pb-2 text-blue-600"> ตั้งค่าการคำนวณ</h2>
<div class="space-y-4">
<div>
<label class="block text-sm font-medium text-slate-600" for="province_selector">เลือกจังหวัด <span style="font-size:12px;color:#888;">(อัตราค่าแรงตามจังหวัด)</span></label>
<select class="form-input mt-1 block w-full" id="province_selector"></select>
</div>
<div class="hidden" id="bkk_zone_container">
<label class="block text-sm font-medium text-slate-600" for="bkk_zone_selector">เลือกโซนในกรุงเทพฯ</label>
<select class="form-input mt-1 block w-full" id="bkk_zone_selector">
<option value="BKK_Zone1_CBD">โซน 1: Core CBD (สาทร/สีลม)</option>
<option value="BKK_Zone2_Transit">โซน 2: Transit Hub (พระโขนง)</option>
<option value="BKK_Zone3_Industrial">โซน 3: Industrial Hub (ลาดกระบัง)</option>
<option value="BKK_Zone4_MidTier">โซน 4: Mid-Tier (ลาดพร้าว)</option>
<option selected="" value="BKK_Zone5_Suburban">โซน 5: Suburban (มีนบุรี)</option>
</select>
</div>
<div>
<label class="block text-sm font-medium text-slate-600" for="material_quality">คุณภาพวัสดุ</label>
<select class="form-input mt-1 block w-full" id="material_quality">
<option value="1.0">มาตรฐาน (เช่น Nano, Chang)</option>
<option value="1.4">คุณภาพ (เช่น Panasonic)</option>
<option value="1.8">พรีเมียม (เช่น Schneider)</option>
</select>
</div>
<div>
<label class="block text-sm font-medium text-slate-600" for="min_charge">ค่าบริการขั้นต่ำ (บาท) <span class="font-normal text-slate-400">(จะใช้เมื่อยอดไม่ถึง)</span></label>
<input class="form-input mt-1 block w-full" id="min_charge" type="number" value="1000"/>
</div>
<div>
<label class="block text-sm font-medium text-slate-600" for="wastage_factor">เผื่อวัสดุเสียหาย (%)</label>
<input class="form-input mt-1 block w-full" id="wastage_factor" type="number" value="0"/>
</div>
<div>
<label class="block text-sm font-medium text-slate-600" for="overhead_factor">ค่าดำเนินการ (%)</label>
<input class="form-input mt-1 block w-full" id="overhead_factor" type="number" value="0"/>
</div>
<div>
<label class="block text-sm font-medium text-slate-600" for="profit_factor">กำไร (%)</label>
<input class="form-input mt-1 block w-full" id="profit_factor" type="number" value="0"/>
</div>
<div class="pt-2 border-t border-slate-200">
<label class="flex items-center">
<input class="h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500" id="include_vat" type="checkbox"/>
<span class="ml-2 text-sm font-medium text-slate-700">คิด VAT 7%</span>
</label>
</div>
</div>
</section>
<h2 class="text-2xl font-bold text-blue-600 border-b-2 border-slate-200 pb-2"> ระบุรายละเอียดงาน</h2>
<!-- === ส่วนงานเดินสายเมนภายนอก (อัปเดตแล้ว) === -->
                <div class="config-card">
                    <button class="accordion-btn flex items-center justify-between w-full py-3 px-4 bg-slate-50 hover:bg-blue-50 rounded-lg transition cursor-pointer">
                        <div class="flex items-center gap-3">
                            <svg class="w-5 h-5 text-blue-600"><use href="#ic-plug"></use></svg>
                            <span class="font-semibold text-slate-700 text-lg">งานเดินสายเมินไฟฟ้าภายนอก</span>
                        </div>
                        <svg class="w-5 h-5 text-slate-600 arrow transition"><path d="M6 9l6 6 6-6"></path></svg>
                    </button>
                    <div class="accordion-content"> <!-- เริ่มแบบเปิดไว้ -->
                        <div class="space-y-4">
                            <!-- ส่วนเสาและแร็ค (อัปเดต "1 ชุด") -->
                            <div class="p-4 border rounded-lg bg-blue-50 space-y-4">
                                <h4 class="font-semibold text-blue-800">ส่วนเสาไฟฟ้าและแร็ค</h4>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-medium text-slate-600" for="pole_height_7">ความสูงเสา</label>
                                        <select class="form-input mt-1 block w-full" id="pole_height_7">
                                            <option value="0">-- ไม่ปักเสา --</option>
                                            <option value="6.0">6.0 เมตร</option>
                                            <option value="7.0">7.0 เมตร</option>
                                            <option value="8.0">8.0 เมตร</option>
                                            <option value="9.0">9.0 เมตร</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-slate-600" for="pole_count_7">จำนวนเสาที่ปัก (ต้น)</label>
                                        <input class="form-input mt-1 block w-full" id="pole_count_7" min="0" placeholder="0" type="number" />
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-slate-600" for="rack_2_sets_7">ติดตั้งแร็ค 2 ชุด (ต้น)</label>
                                        <input class="form-input mt-1 block w-full" id="rack_2_sets_7" min="0" placeholder="0" type="number" />
                                    </div>
                                    <div>
                                        <!-- อัปเดต: 4 ชุด เป็น 1 ชุด -->
                                        <label class="block text-sm font-medium text-slate-600" for="rack_1_set_7">ติดตั้งแร็ค 1 ชุด (ต้น)</label>
                                        <input class="form-input mt-1 block w-full" id="rack_1_set_7" min="0" placeholder="0" type="number" />
                                    </div>
                                </div>
                            </div>

                            <!-- ส่วนสายเมน (ยกเครื่องใหม่ทั้งหมด) -->
                            <div class="p-4 border rounded-lg bg-blue-50 space-y-4">
                                <h4 class="font-semibold text-blue-800">ส่วนสายเมนภายนอก (เดินลอย)</h4>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    
                                    <div>
                                        <label class="block text-sm font-medium text-slate-600" for="main_ext_type_7">ประเภทสาย</label>
                                        <select class="form-input mt-1 block w-full" id="main_ext_type_7">
                                            <option value="THW">ทองแดง (THW)</option>
                                            <option value="THW-A">อลูมิเนียม (THW-A)</option>
                                        </select>
                                    </div>

                                    <div>
                                        <label class="block text-sm font-medium text-slate-600" for="main_ext_size_7">ขนาดสาย (ตร.มม.)</label>
                                        <select class="form-input mt-1 block w-full" id="main_ext_size_7">
                                            <option value="4">4 sq.mm.</option>
                                            <option value="10">10 sq.mm.</option>
                                            <option value="16">16 sq.mm.</option>
                                            <option value="25">25 sq.mm.</option>
                                            <option value="35">35 sq.mm.</option>
                                            <option value="50">50 sq.mm.</option>
                                        </select>
                                    </div>

                                    <div class="md:col-span-2">
                                        <label class="block text-sm font-medium text-slate-600" for="main_ext_dist_7">ระยะทาง (เมตร)</label>
                                        <input class="form-input mt-1 block w-full" id="main_ext_dist_7" min="0" placeholder="0" type="number" />
                                        <!-- === อัปเดต: เพิ่มคำอธิบายตามที่ผู้ใช้ขอ === -->
                                        <p class="text-xs text-slate-500 mt-1">
                                            *กรอกระยะทางจริง (ม.) จากมิเตอร์ไปตู้ไฟ ระบบจะคูณ 2 (L, N) สำหรับคำนวณปริมาณสายไฟโดยอัตโนมัติ
                                        </p>
                                    </div>

                                    <!-- ลบ: ขนาดสายเมนที่แนะนำ -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
<div class="config-card">
<button class="accordion-btn flex items-center justify-between w-full py-3 px-4 bg-slate-50 hover:bg-blue-50 rounded-lg transition cursor-pointer"><div class="flex items-center gap-3"><svg class="w-5 h-5 text-blue-600"><use href="#ic-plug"></use></svg><span class="font-semibold text-slate-700 text-lg">ตู้ควบคุมและเบรกเกอร์</span></div><svg class="w-5 h-5 text-slate-600 arrow transition"><path d="M6 9l6 6 6-6"></path></svg></button><div class="accordion-content hidden">
<div class="grid grid-cols-1 md:grid-cols-2 gap-4 items-end">
<div>
<label class="block text-sm font-medium text-slate-600" for="cu_replacement">เปลี่ยนตู้คอนซูมเมอร์ยูนิต (CU)</label>
<select class="form-input mt-1 block w-full" id="cu_replacement">
<option value="none">-- ไม่เปลี่ยน --</option>
<option value="4_slot">4 ช่อง</option>
<option value="6_slot">6 ช่อง</option>
<option value="8_slot">8 ช่อง</option>
<option value="10_slot">10 ช่อง</option>
<option value="12_slot">12 ช่อง</option>
</select>
</div>
<div class="space-y-2">
<label class="flex items-center">
<input class="h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500" id="install_ground" type="checkbox"/>
<span class="ml-2 text-slate-700">ติดตั้งหลักดินใหม่</span>
</label>
<div>
<label class="block text-xs font-medium text-slate-500" for="ground_distance">ระยะสายดินไปตู้ไฟ (เมตร)</label>
<input class="form-input mt-1 block w-full sm:text-sm" id="ground_distance" min="0" placeholder="0" type="number"/>
</div>
</div>
</div>
<div class="mt-4 pt-4 border-t">
<h4 class="text-md font-semibold text-slate-800">เพิ่มเบรกเกอร์ลูกย่อย (MCB)</h4>
<div class="grid grid-cols-2 md:grid-cols-3 gap-3 mt-2">
<div>
<label class="block text-xs font-medium text-slate-500" for="mcb_16a">16A (แสงสว่าง)</label>
<input class="form-input mt-1 block w-full sm:text-sm" id="mcb_16a" min="0" placeholder="0" type="number"/>
</div>
<div>
<label class="block text-xs font-medium text-slate-500" for="mcb_20a">20A (เต้ารับ/แอร์)</label>
<input class="form-input mt-1 block w-full sm:text-sm" id="mcb_20a" min="0" placeholder="0" type="number"/>
</div>
<div>
<label class="block text-xs font-medium text-slate-500" for="mcb_32a">32A (น้ำอุ่น/ปั๊ม)</label>
<input class="form-input mt-1 block w-full sm:text-sm" id="mcb_32a" min="0" placeholder="0" type="number"/>
</div>
</div>
</div>
</div></div>
<div class="config-card">
<button class="accordion-btn flex items-center justify-between w-full py-3 px-4 bg-slate-50 hover:bg-blue-50 rounded-lg transition cursor-pointer"><div class="flex items-center gap-3"><svg class="w-5 h-5 text-blue-600"><use href="#ic-outlet"></use></svg><span class="font-semibold text-slate-700 text-lg">งานเต้ารับไฟฟ้า</span></div><svg class="w-5 h-5 text-slate-600 arrow transition"><path d="M6 9l6 6 6-6"></path></svg></button><div class="accordion-content hidden">
<div class="grid grid-cols-1 md:grid-cols-2 gap-4">
<div>
<label class="block text-sm font-medium text-slate-600" for="socket_circuits">จำนวนวงจรเต้ารับ</label>
<input class="form-input mt-1 block w-full" id="socket_circuits" min="0" placeholder="0" type="number"/>
</div>
<div>
<label class="block text-sm font-medium text-slate-600" for="socket_type">รูปแบบติดตั้ง</label>
<select class="form-input mt-1 block w-full" id="socket_type">
<option value="surface_vaf">เดินลอย ตีกิ๊ป (VAF)</option>
<option value="surface_pvc">เดินในท่อ PVC ลอย</option>
<option value="concealed_pvc">เดินในท่อ PVC ฝังผนัง (รวมกรีด/ฉาบ)</option>
<option value="surface_emt">เดินในท่อ EMT ลอย</option>
<option value="surface_pvc_trunking">เดินในราง PVC ขาว</option>
</select>
</div>
</div>
<div class="mt-4 space-y-4" id="socket_circuits_container"></div>
</div></div>
<div class="config-card">
<button class="accordion-btn flex items-center justify-between w-full py-3 px-4 bg-slate-50 hover:bg-blue-50 rounded-lg transition cursor-pointer"><div class="flex items-center gap-3"><svg class="w-5 h-5 text-blue-600"><use href="#ic-light"></use></svg><span class="font-semibold text-slate-700 text-lg">งานแสงสว่าง</span></div><svg class="w-5 h-5 text-slate-600 arrow transition"><path d="M6 9l6 6 6-6"></path></svg></button><div class="accordion-content hidden">
<div class="grid grid-cols-1 md:grid-cols-2 gap-4">
<div>
<label class="block text-sm font-medium text-slate-600" for="light_circuits">จำนวนวงจรแสงสว่าง</label>
<input class="form-input mt-1 block w-full" id="light_circuits" min="0" placeholder="0" type="number"/>
</div>
<div>
<label class="block text-sm font-medium text-slate-600" for="light_type">รูปแบบติดตั้ง</label>
<select class="form-input mt-1 block w-full" id="light_type">
<option value="surface_pvc">เดินในท่อ PVC ลอย</option>
<option value="concealed_pvc">เดินในท่อ PVC ฝังฝ้า/ผนัง (รวมกรีด/ฉาบ)</option>
<option value="surface_emt">เดินในท่อ EMT ลอย</option>
<option value="surface_pvc_trunking">เดินในราง PVC ขาว</option>
</select>
</div>
<div class="md:col-span-2">
<label class="block text-sm font-medium text-slate-600" for="fixture_type_1">ประเภทโคมไฟ</label>
<select class="form-input mt-1 block w-full" id="fixture_type_1">
<option value="LED_E27">โคมดาวน์ไลท์ + หลอด LED E27 (ค่าเริ่มต้น)</option>
<option value="LED_PANEL">โคมไฟฝังฝ้า LED สำเร็จรูป (Panel Light)</option>
<option value="T8_SET">ชุดโคมไฟฟลูออเรสเซนต์ T8</option>
</select>
</div>
</div>
<div class="mt-4 space-y-4" id="light_circuits_container"></div>
</div></div>
<div class="config-card">
<button class="accordion-btn flex items-center justify-between w-full py-3 px-4 bg-slate-50 hover:bg-blue-50 rounded-lg transition cursor-pointer"><div class="flex items-center gap-3"><svg class="w-5 h-5 text-blue-600"><use href="#ic-plug"></use></svg><span class="font-semibold text-slate-700 text-lg">งานเดินสายไฟเฉพาะจุด (แอร์/น้ำอุ่น)</span></div><svg class="w-5 h-5 text-slate-600 arrow transition"><path d="M6 9l6 6 6-6"></path></svg></button><div class="accordion-content hidden">
<div class="space-y-4 pt-4 border-t">
<h4 class="font-semibold text-slate-800 border-b pb-2">งานเดินสายไฟเครื่องปรับอากาศ</h4>
<div class="grid grid-cols-1 md:grid-cols-3 gap-4">
<div>
<label class="block text-sm font-medium text-slate-600" for="ac_wiring_units">จำนวนเครื่อง</label>
<input class="form-input mt-1 block w-full" id="ac_wiring_units" min="0" placeholder="0" type="number"/>
</div>
<div class="md:col-span-2">
<label class="block text-sm font-medium text-slate-600" for="ac_install_type_4">รูปแบบติดตั้ง</label>
<select class="form-input mt-1 block w-full" id="ac_install_type_4">
<option value="surface_pvc">เดินในท่อ PVC ลอย (THW)</option>
<option value="concealed_pvc">เดินในท่อ PVC ฝัง (THW)</option>
<option value="surface_emt">เดินในท่อ EMT ลอย (THW)</option>
<option value="surface_pvc_trunking">เดินในราง PVC ขาว</option>
</select>
</div>
</div>
<div class="mt-4 space-y-4" id="ac_wiring_circuits_container"></div>
</div>
<div class="space-y-4 pt-4 border-t mt-6">
<h4 class="font-semibold text-slate-800 border-b pb-2">งานเดินสายไฟเครื่องทำน้ำอุ่น</h4>
<div class="grid grid-cols-1 md:grid-cols-3 gap-4">
<div>
<label class="block text-sm font-medium text-slate-600" for="heater_wiring_units">จำนวนเครื่อง</label>
<input class="form-input mt-1 block w-full" id="heater_wiring_units" min="0" placeholder="0" type="number"/>
</div>
<div class="md:col-span-2">
<label class="block text-sm font-medium text-slate-600" for="wh_install_type_5">รูปแบบติดตั้ง</label>
<select class="form-input mt-1 block w-full" id="wh_install_type_5">
<option value="surface_pvc">เดินในท่อ PVC ลอย (THW)</option>
<option value="concealed_pvc">เดินในท่อ PVC ฝัง (THW)</option>
<option value="surface_emt">เดินในท่อ EMT ลอย (THW)</option>
<option value="surface_pvc_trunking">เดินในราง PVC ขาว</option>
</select>
</div>
</div>
<div class="mt-4 space-y-4" id="heater_wiring_circuits_container"></div>
</div>
</div></div>
<div class="config-card">
<button class="accordion-btn flex items-center justify-between w-full py-3 px-4 bg-slate-50 hover:bg-blue-50 rounded-lg transition cursor-pointer"><div class="flex items-center gap-3"><svg class="w-5 h-5 text-blue-600"><use href="#ic-plug"></use></svg><span class="font-semibold text-slate-700 text-lg">งานระบบแรงดันต่ำและสื่อสาร</span></div><svg class="w-5 h-5 text-slate-600 arrow transition"><path d="M6 9l6 6 6-6"></path></svg></button><div class="accordion-content hidden">
<div class="space-y-4">
<div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-2">
<div>
<label class="block text-sm font-medium text-slate-600" for="lan_points">จุด LAN (Cat6)</label>
<input class="form-input mt-1 block w-full" id="lan_points" min="0" placeholder="0" type="number"/>
</div>
<div>
<label class="block text-sm font-medium text-slate-600" for="lan_distance">ระยะเดินสาย LAN (รวมทุกจุด)</label>
<input class="form-input mt-1 block w-full" id="lan_distance" min="0" placeholder="0" type="number"/>
</div>
<div>
<label class="block text-sm font-medium text-slate-600" for="tv_points">จุด TV (RG6)</label>
<input class="form-input mt-1 block w-full" id="tv_points" min="0" placeholder="0" type="number"/>
</div>
<div>
<label class="block text-sm font-medium text-slate-600" for="tv_distance">ระยะเดินสาย TV (รวมทุกจุด)</label>
<input class="form-input mt-1 block w-full" id="tv_distance" min="0" placeholder="0" type="number"/>
</div>
<div class="md:col-span-2">
<label class="block text-sm font-medium text-slate-600" for="cctv_points">จุดกล้องวงจรปิด (CCTV)</label>
<input class="form-input mt-1 block w-full" id="cctv_points" min="0" placeholder="0" type="number"/>
</div>
</div>
</div>
</div></div>
<div class="config-card">
<button class="accordion-btn flex items-center justify-between w-full py-3 px-4 bg-slate-50 hover:bg-blue-50 rounded-lg transition cursor-pointer"><div class="flex items-center gap-3"><svg class="w-5 h-5 text-blue-600"><use href="#ic-plug"></use></svg><span class="font-semibold text-slate-700 text-lg">งานติดตั้งเครื่องใช้ไฟฟ้า</span></div><svg class="w-5 h-5 text-slate-600 arrow transition"><path d="M6 9l6 6 6-6"></path></svg></button><div class="accordion-content hidden">
<div class="space-y-4">
<div>
<h4 class="font-semibold text-slate-800 border-b pb-2">งานติดตั้งเครื่องใช้ไฟฟ้า (ไม่รวมสายไฟ)</h4>
<div class="grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-2 mt-2">
<div>
<label class="block text-sm font-medium text-slate-600" for="heater_units">เครื่องทำน้ำอุ่น (เครื่อง)</label>
<input class="form-input mt-1 block w-full" id="heater_units" min="0" placeholder="0" type="number"/>
</div>
<div class="flex items-center mt-1">
<input class="h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500" id="heater_exclude_hoses" type="checkbox"/>
<label class="ml-2 block text-sm font-medium text-slate-700" for="heater_exclude_hoses">ไม่รวมสายน้ำดี (แถมมากับเครื่อง)</label>
</div>
<div>
<label class="block text-sm font-medium text-slate-600" for="ac_units">เครื่องปรับอากาศ (เครื่อง)</label>
<input class="form-input mt-1 block w-full" id="ac_units" min="0" placeholder="0" type="number"/>
</div>
<div class="hidden"> <label class="block text-sm font-medium text-slate-600" for="ac_distance">ระยะสายไฟแอร์ (ม./เครื่อง)</label>
<input class="form-input mt-1 block w-full" id="ac_distance" min="0" placeholder="15" type="number"/>
</div>
<div>
<label class="block text-sm font-medium text-slate-600" for="pump_units">ปั๊มน้ำ (เครื่อง)</label>
<input class="form-input mt-1 block w-full" id="pump_units" min="0" placeholder="0" type="number"/>
</div>
<div>
<label class="block text-sm font-medium text-slate-600" for="wp_install_type_6">รูปแบบติดตั้งปั๊มน้ำ</label>
<select class="form-input mt-1 block w-full" id="wp_install_type_6">
<option value="pvc_clip">เดินท่อ PVC ขาว ตีกิ๊บ (THW)</option>
<option value="vct_clip">เดินสาย VCT ตีกิ๊บ</option>
<option value="nyy_burial">เดินร้อยท่อฝังดิน (สาย NYY)</option>
</select>
</div>
<div>
<label class="block text-sm font-medium text-slate-600" for="fan_units">พัดลมเพดาน/ดูดอากาศ (เครื่อง)</label>
<input class="form-input mt-1 block w-full" id="fan_units" min="0" placeholder="0" type="number"/>
</div>
</div>
</div>
</div>
</div></div>
<div class="config-card">
<button class="accordion-btn flex items-center justify-between w-full py-3 px-4 bg-slate-50 hover:bg-blue-50 rounded-lg transition cursor-pointer"><div class="flex items-center gap-3"><svg class="w-5 h-5 text-blue-600"><use href="#ic-plug"></use></svg><span class="font-semibold text-slate-700 text-lg">งานบริการและตรวจซ่อม</span></div><svg class="w-5 h-5 text-slate-600 arrow transition"><path d="M6 9l6 6 6-6"></path></svg></button><div class="accordion-content hidden">
<div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
<label class="flex items-start p-3 bg-slate-50 rounded-lg border has-[:checked]:bg-blue-50 has-[:checked]:border-blue-400">
<input class="h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mt-1" id="service_inspection" type="checkbox"/>
<span class="ml-3 text-sm">
<span class="font-semibold text-slate-800">ตรวจเช็คระบบไฟฟ้าประจำปี</span>
<p class="text-slate-500">ตรวจสอบความปลอดภัยโดยรวม</p>
</span>
</label>
<label class="flex items-start p-3 bg-slate-50 rounded-lg border has-[:checked]:bg-blue-50 has-[:checked]:border-blue-400">
<input class="h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mt-1" id="service_leak_find" type="checkbox"/>
<span class="ml-3 text-sm">
<span class="font-semibold text-slate-800">ค้นหาจุดไฟฟ้ารั่ว</span>
<p class="text-slate-500">แก้ปัญหาค่าไฟสูง, อันตราย</p>
</span>
</label>
<label class="flex items-start p-3 bg-slate-50 rounded-lg border has-[:checked]:bg-blue-50 has-[:checked]:border-blue-400">
<input class="h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mt-1" id="service_trip_find" type="checkbox"/>
<span class="ml-3 text-sm">
<span class="font-semibold text-slate-800">ตรวจสอบเบรกเกอร์ทริป</span>
<p class="text-slate-500">หาสาเหตุไฟดับบ่อย</p>
</span>
</label>
<div class="flex items-center space-x-2 p-3 bg-slate-50 rounded-lg border">
<label class="text-sm font-semibold text-slate-800" for="service_lamp_replace">เปลี่ยนหลอดไฟ</label>
<input class="form-input block w-full sm:text-sm" id="service_lamp_replace" min="0" placeholder="0" type="number"/>
<span class="text-sm text-slate-600">จุด</span>
</div>
</div>
</div></div>
<div class="config-card">
<button class="accordion-btn flex items-center justify-between w-full py-3 px-4 bg-slate-50 hover:bg-blue-50 rounded-lg transition cursor-pointer"><div class="flex items-center gap-3"><svg class="w-5 h-5 text-blue-600"><use href="#ic-plug"></use></svg><span class="font-semibold text-slate-700 text-lg">งานติดตั้งเครื่องชาร์จ EV</span></div><svg class="w-5 h-5 text-slate-600 arrow transition"><path d="M6 9l6 6 6-6"></path></svg></button><div class="accordion-content hidden">
<div class="flex items-center justify-between mb-4 border-b pb-2">
<label class="flex items-center cursor-pointer w-full" for="toggle_ev_charger_visibility">
<span class="mr-3 text-sm font-medium text-slate-700">คำนวณงานติดตั้ง EV Charger</span>
<div class="relative ml-auto">
<input class="sr-only peer" id="toggle_ev_charger_visibility" type="checkbox"/>
<div class="block bg-gray-200 peer-checked:bg-blue-600 w-14 h-8 rounded-full"></div>
<div class="dot absolute left-1 top-1 bg-white w-6 h-6 rounded-full transition-transform transform peer-checked:translate-x-full"></div>
</div>
</label>
</div>
<div class="p-4 border rounded-lg bg-blue-50 space-y-4 hidden" id="ev_charger_content_wrapper">
<div class="grid grid-cols-1 md:grid-cols-2 gap-4">
<div>
<label class="block text-sm font-medium text-slate-600" for="ev_install_type_8">รูปแบบการติดตั้ง</label>
<select class="form-input mt-1 block w-full" id="ev_install_type_8">
<option value="existing_meter">พ่วงกับมิเตอร์เดิม</option>
<option value="new_meter_tou">ขอติดตั้งมิเตอร์ลูกที่ 2 (TOU)</option>
</select>
</div>
<div>
<label class="block text-sm font-medium text-slate-600" for="ev_power_8">กำลังไฟของเครื่องชาร์จ</label>
<select class="form-input mt-1 block w-full" id="ev_power_8">
<option value="7.4kW"> 4 kW (1 เฟส)</option>
<option value="22kW">22 kW (3 เฟส)</option>
</select>
</div>
</div>
<div class="grid grid-cols-1 md:grid-cols-2 gap-4">
<div>
<label class="block text-sm font-medium text-slate-600" for="ev_cable_dist_8">ระยะทางเดินสาย (เมตร)</label>
<input class="form-input mt-1 block w-full" id="ev_cable_dist_8" min="0" placeholder="20" type="number" value="20"/>
</div>
<div>
<label class="block text-sm font-medium text-slate-600" for="ev_charger_cost_8">ค่าเครื่อง EV Charger (ถ้าซื้อมาเองใส่ 0)</label>
<input class="form-input mt-1 block w-full" id="ev_charger_cost_8" min="0" placeholder="35000" type="number" value="35000"/>
</div>
</div>
</div>
</div></div>
<div class="config-card">
<button class="accordion-btn flex items-center justify-between w-full py-3 px-4 bg-slate-50 hover:bg-blue-50 rounded-lg transition cursor-pointer"><div class="flex items-center gap-3"><svg class="w-5 h-5 text-blue-600"><use href="#ic-plug"></use></svg><span class="font-semibold text-slate-700 text-lg">งานรื้อถอนและย้ายแนว</span></div><svg class="w-5 h-5 text-slate-600 arrow transition"><path d="M6 9l6 6 6-6"></path></svg></button><div class="accordion-content hidden">
<div class="p-4 border rounded-lg bg-red-50 space-y-4">
<div class="grid grid-cols-1 md:grid-cols-4 gap-4">
<div>
<label class="block text-sm font-medium text-slate-600" for="demo_lights_9">รื้อดวงโคม (จุด)</label>
<input class="form-input mt-1 block w-full" id="demo_lights_9" min="0" placeholder="0" type="number" value="0"/>
</div>
<div>
<label class="block text-sm font-medium text-slate-600" for="demo_outlets_9">รื้อเต้ารับ/สวิตช์ (จุด)</label>
<input class="form-input mt-1 block w-full" id="demo_outlets_9" min="0" placeholder="0" type="number" value="0"/>
</div>
<div>
<label class="block text-sm font-medium text-slate-600" for="demo_cables_9">รื้อสาย/ท่อ (เมตร)</label>
<input class="form-input mt-1 block w-full" id="demo_cables_9" min="0" placeholder="0" type="number" value="0"/>
</div>
<div>
<label class="block text-sm font-medium text-slate-600" for="demo_ac_9">รื้อเครื่องปรับอากาศ (เครื่อง)</label>
<input class="form-input mt-1 block w-full" id="demo_ac_9" min="0" placeholder="0" type="number" value="0"/>
</div>
</div>
<div class="mt-4">
<label class="flex items-center">
<input class="h-4 w-4 text-red-600 border-gray-300 rounded focus:ring-red-500" id="demo_include_repair_9" type="checkbox"/>
<span class="ml-2 text-slate-700">รวมค่าแรงอุด/ซ่อม/ฉาบผนัง (ต่อจุด)</span>
</label>
</div>
</div>
</div></div>
</div>
<div class="sticky top-8">
<section class="bg-white p-6 rounded-xl shadow-xl">
<h2 class="text-2xl font-bold mb-4 border-b pb-2 text-blue-600">สรุปราคาเบื้องต้น</h2>
<div class="text-center py-4" id="realtime-total">
<p class="text-lg text-slate-500" id="total-display-label">ยอดรวมสุทธิ</p>
<p class="text-5xl font-bold text-slate-800 my-2" id="total-display">฿0.00</p>
</div>
<div class="mt-4 grid grid-cols-3 gap-3">
<button class="col-span-2 btn btn-primary text-lg" id="calculate-btn">
                           คำนวณและสร้างเอกสาร
                       </button>
<button class="btn btn-secondary text-lg" id="reset-btn">
                           รีเซ็ต
                       </button>
</div>
</section>
<section class="bg-white p-6 rounded-lg shadow-lg mt-6" id="price-editor-section">
<h2 class="text-2xl font-bold mb-4 border-b pb-2 text-blue-600"> แก้ไขราคา (บาท)</h2>
<div class="max-h-60 overflow-y-auto">
<table class="w-full text-sm">
<thead class="bg-slate-50 sticky top-0">
<tr>
<th class="p-2 text-left font-medium text-slate-500">รหัส</th>
<th class="p-2 text-left font-medium text-slate-500">ราคา/หน่วย</th>
</tr>
</thead>
<tbody id="price-editor-body"></tbody>
</table>
</div>
</section>
</div>
</main>
<section class="mt-12 bg-white p-6 rounded-lg shadow-lg hidden" id="output-section">
<div class="flex justify-between items-center border-b pb-2 mb-4 no-print">
<h2 class="text-2xl font-bold text-blue-600"> เอกสารประมาณราคา</h2>
<div class="flex items-center gap-2">
<button class="no-print bg-red-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-red-700 transition-colors flex items-center" id="save-pdf-btn">
<svg class="mr-2" fill="none" height="20" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" x2="8" y1="13" y2="13"></line><line x1="16" x2="8" y1="17" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>
                        บันทึก PDF
                    </button>
<button class="no-print bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors flex items-center" id="save-image-btn">
<svg class="mr-2" fill="none" height="20" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="20" xmlns="http://www.w3.org/2000/svg"><rect height="18" rx="2" ry="2" width="18" x="3" y="3"></rect><circle cx="8.5" cy="8.5" r="1.5"></circle><polyline points="21 15 16 10 5 21"></polyline></svg>
                        บันทึกภาพ
                    </button>
<button class="no-print bg-gray-700 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-800 transition-colors flex items-center" id="print-btn">
<svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path></svg>
                        พิมพ์
                    </button>
</div>
</div>
<p class="text-right text-sm h-5 mb-2" id="print-status"></p>
<div class="no-print">
<div class="border-b border-gray-200">
<nav aria-label="Tabs" class="-mb-px flex space-x-6">
<button class="tab-btn tab-active py-2 px-1 border-b-2 font-medium text-sm" data-tab="boq-combined">BOQ รวม</button>
<button class="tab-btn py-2 px-1 border-b-2 font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300" data-tab="boq-labor">BOQ ค่าแรง</button>
<button class="tab-btn py-2 px-1 border-b-2 font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300" data-tab="boq-material">BOQ ค่าวัสดุ</button>
<button class="tab-btn py-2 px-1 border-b-2 font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300" data-tab="purchase-order">ใบสั่งซื้อ</button>
</nav>
</div>
</div>
<div class="mt-4" id="report-content"></div>
</section>
<footer class="text-center mt-12 text-xs text-gray-500 no-print">
<p id="citation-text">การคำนวณอ้างอิงตาม: บัญชีราคากลางค่าแรงงานจากกรมบัญชีกลาง, มาตรฐานการติดตั้งทางไฟฟ้าสำหรับประเทศไทย (วสท.), และราคาวัสดุโดยเฉลี่ย</p>
</footer>
</div>
<div class="hidden" id="print-area"></div>
<style>
.arrow { transition: transform .25s ease; }
.rotate-180 { transform: rotate(180deg); }
</style>
<script src="js/script.js"></script>
<script src="js/script.js"></script>
</body>
</html>
<script src="js/script.js"></script>
